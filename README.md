# OnlineChat
Многопользовательский онлайн-чат. C++17, Qt 6 (widgets, network, sql).

Клиентская часть:
  - общий чат для всех пользователей
  - приватные чаты
  - история сообщений (загружается при входе, открытии вкладки личных сообщений)
  - автоматическое переподключение при потере соединения
  - отображение списка онлайн-пользователей
  - возможность смены имени пользователя
  - пользовательский интерфейс
  - кастомный протокол

1. Главное окно: 
    - управление стеком виджетов: переключение между страницами входа, регистрации и чата
    - обработка пользовательского ввода: валидация полей, подсветка ошибок
    - хранение ID пользователя, открытых вкладок:
```cpp
QHash<int, int> idToTabIndex;  // ID пользователя -> индекс вкладки
QHash<int, QTextEdit*> idToField; // ID пользователя -> поле для сообщений
QHash<int, int> tabIndexToId;  // индекс вкладки -> ID пользователя
```

2. Список онлайн-пользователей
    - обновляется при получении пакета UpdateOnline от сервера
    - отображает активных пользователей в виде списка кнопок
    - при нажатии на кнопку открывается приватный диалог

3. Обработка входящих данных (аналогична серверной)
    - асинхронное чтение с контролем размера пакета
    - буферизация неполных данных
    - разбор по кодам операций в switch'е 

4. Автоматическое переподключение
    - при дисконнекте испускается сигнал и запускается таймер reconnectTimer c интервалом 3 секунды:
       ```cpp
       emit connectionLost();
       reconnectTimer->start();
       ```
    - при потере соединения отключаются кнопки входа, регистрации и другие, при нажатии которых отправляется пакет

5. Взаимодействие с окном смены имени
     - при нажатии кнопки смены имени окно испускает сигнал `changeNameBtnClicked(ui.changeNameField->text())` с новым именем
     - главное окно ловит сигнал и отправляет запрос на сервер:
   ```cpp
       connect(&dialog, &nameChangeDialog::changeNameBtnClicked, this, [this](QString newName) {
    sendPacket(clientQuery::NameChange, newName);
    });
   ```
     - при получении ответа от сервера испускается сигнал, который ловит дочернее окно:
   ```cpp
   case serverResponse::Successful:
    emit nameChangeAccepted(toStr(serverResponse::Successful));
    ui.nameField->setText(data);
    break;
   ```
     - окно смены имени выводит пользователю результат (имя изменено/имя занято/и т.д.)
    
Скачать сборку под Windows: https://github.com/L3n44nd/OnlineChatClient/releases/download/v1.0.1/OnlineChatClient.zip
